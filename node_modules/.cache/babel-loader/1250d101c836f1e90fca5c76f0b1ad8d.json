{"ast":null,"code":"import _regeneratorRuntime from\"/github/workspace/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/github/workspace/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/github/workspace/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{faCaretDown,faCaretUp}from'@fortawesome/free-solid-svg-icons';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{motion}from'framer-motion';import React,{useEffect,useRef,useState}from'react';import{useIndexedDB}from'react-indexed-db';import SunEditor from'suneditor-react';import xss from'xss';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var editorOption={mode:'inline',buttonList:[['paragraphStyle','blockquote','bold','underline','italic','strike','subscript','superscript','fontColor','hiliteColor','textStyle','removeFormat','outdent','indent','align','horizontalRule','list','lineHeight','table','link','image','video','audio','imageGallery','fullScreen','showBlocks','codeView','preview','template']]};export default function Card(_ref){var year=_ref.year,month=_ref.month,day=_ref.day;var _useIndexedDB=useIndexedDB('diary'),getByID=_useIndexedDB.getByID,add=_useIndexedDB.add,deleteRecord=_useIndexedDB.deleteRecord;var _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),diary=_React$useState2[0],setDiary=_React$useState2[1];var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isEditorVisible=_useState2[0],setEditorVisiblity=_useState2[1];var editor=useRef();var getSunEditorInstance=function getSunEditorInstance(sunEditor){editor.current=sunEditor;};useEffect(function(){dataFetch();setEditorVisiblity(false);},[year,month,day]);function apply(){return _apply.apply(this,arguments);}function _apply(){_apply=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var id,_editor$current,_editor$current2;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:id=parseInt(\"\".concat(year.toString().padStart(2,'0')).concat(month.toString().padStart(2,'0')).concat(day.toString().padStart(2,'0')));if(diary){_context.next=6;break;}_context.next=4;return add({id:id,content:(_editor$current=editor.current)===null||_editor$current===void 0?void 0:_editor$current.getContents(true),date:Date.now().toString()});case 4:_context.next=10;break;case 6:_context.next=8;return deleteRecord(id);case 8:_context.next=10;return add({id:id,content:(_editor$current2=editor.current)===null||_editor$current2===void 0?void 0:_editor$current2.getContents(true),date:Date.now().toString()});case 10:setEditorVisiblity(false);dataFetch();case 12:case\"end\":return _context.stop();}}},_callee);}));return _apply.apply(this,arguments);}function dataFetch(){getByID(parseInt(\"\".concat(year.toString().padStart(2,'0')).concat(month.toString().padStart(2,'0')).concat(day.toString().padStart(2,'0')))).then(function(v){return setDiary(v);});}return/*#__PURE__*/_jsxs(motion.div,{initial:{translateX:'200%'},animate:{translateX:0},transition:{delay:1,duration:0.3},className:\"w-2/3\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'#353A45'},className:\"shadow-md p-5 w-full rounded-xl\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"font-pen text-4xl\",children:[year,\"\\uB144 \",month,\"\\uC6D4 \",day,\"\\uC77C \\uC77C\\uAE30\"]}),!diary&&/*#__PURE__*/_jsx(\"p\",{children:\"\\uC544\\uC9C1 \\uC77C\\uAE30\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"}),!isEditorVisible&&(diary===null||diary===void 0?void 0:diary.content)&&/*#__PURE__*/_jsx(\"div\",{className:\"font-pen text-xl\",dangerouslySetInnerHTML:{__html:xss(diary.content)}}),isEditorVisible&&/*#__PURE__*/_jsxs(\"div\",{className:\"py-3\",children:[/*#__PURE__*/_jsx(SunEditor,{placeholder:\"\\uC5EC\\uAE30\\uB97C \\uB20C\\uB7EC \\uC77C\\uAE30 \\uC791\\uC131\\uC744 \\uC2DC\\uC791\\uD558\\uC138\\uC694\",getSunEditorInstance:getSunEditorInstance,width:\"100%\",height:\"30vh\",defaultValue:diary===null||diary===void 0?void 0:diary.content,setOptions:editorOption}),/*#__PURE__*/_jsx(\"button\",{onClick:apply,className:\"mt-3 rounded-md bg-green-500 px-3 py-2\",children:\"\\uC644\\uB8CC\"})]})]}),new Date(year,month-1,day).getTime()<new Date().getTime()&&/*#__PURE__*/_jsxs(\"button\",{className:\"bg-gray-500 rounded-md px-3 py-2 mt-5\",onClick:function onClick(){return setEditorVisiblity(!isEditorVisible);},children:[!diary?'일기 쓰기':'일기 편집',\" \",/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:isEditorVisible?faCaretDown:faCaretUp})]})]});}","map":{"version":3,"sources":["/github/workspace/src/components/Card.tsx"],"names":["faCaretDown","faCaretUp","FontAwesomeIcon","motion","React","useEffect","useRef","useState","useIndexedDB","SunEditor","xss","editorOption","mode","buttonList","Card","year","month","day","getByID","add","deleteRecord","diary","setDiary","isEditorVisible","setEditorVisiblity","editor","getSunEditorInstance","sunEditor","current","dataFetch","apply","id","parseInt","toString","padStart","content","getContents","date","Date","now","then","v","translateX","delay","duration","backgroundColor","__html","getTime"],"mappings":"qZAAA,OAASA,WAAT,CAAsBC,SAAtB,KAAuC,mCAAvC,CACA,OAASC,eAAT,KAAgC,gCAAhC,CACA,OAASC,MAAT,KAAuB,eAAvB,CACA,MAAOC,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,MAA3B,CAAmCC,QAAnC,KAAmD,OAAnD,CACA,OAASC,YAAT,KAA6B,kBAA7B,CACA,MAAOC,CAAAA,SAAP,KAAsB,iBAAtB,CAGA,MAAOC,CAAAA,GAAP,KAAgB,KAAhB,C,wFAEA,GAAMC,CAAAA,YAAwB,CAAG,CAC/BC,IAAI,CAAE,QADyB,CAE/BC,UAAU,CAAE,CACV,CACE,gBADF,CAEE,YAFF,CAGE,MAHF,CAIE,WAJF,CAKE,QALF,CAME,QANF,CAOE,WAPF,CAQE,aARF,CASE,WATF,CAUE,aAVF,CAWE,WAXF,CAYE,cAZF,CAaE,SAbF,CAcE,QAdF,CAeE,OAfF,CAgBE,gBAhBF,CAiBE,MAjBF,CAkBE,YAlBF,CAmBE,OAnBF,CAoBE,MApBF,CAqBE,OArBF,CAsBE,OAtBF,CAuBE,OAvBF,CAwBE,cAxBF,CAyBE,YAzBF,CA0BE,YA1BF,CA2BE,UA3BF,CA4BE,SA5BF,CA6BE,UA7BF,CADU,CAFmB,CAAjC,CAqCA,cAAe,SAASC,CAAAA,IAAT,MAAmF,IAAlEC,CAAAA,IAAkE,MAAlEA,IAAkE,CAA5DC,KAA4D,MAA5DA,KAA4D,CAArDC,GAAqD,MAArDA,GAAqD,mBACzDT,YAAY,CAAC,OAAD,CAD6C,CACxFU,OADwF,eACxFA,OADwF,CAC/EC,GAD+E,eAC/EA,GAD+E,CAC1EC,YAD0E,eAC1EA,YAD0E,qBAEtEhB,KAAK,CAACG,QAAN,CAAoB,IAApB,CAFsE,oDAEzFc,KAFyF,qBAElFC,QAFkF,mCAGlDf,QAAQ,CAAC,KAAD,CAH0C,wCAGzFgB,eAHyF,eAGxEC,kBAHwE,eAIhG,GAAMC,CAAAA,MAAM,CAAGnB,MAAM,EAArB,CAEA,GAAMoB,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,CAACC,SAAD,CAA8B,CACzDF,MAAM,CAACG,OAAP,CAAiBD,SAAjB,CACD,CAFD,CAIAtB,SAAS,CAAC,UAAM,CACdwB,SAAS,GACTL,kBAAkB,CAAC,KAAD,CAAlB,CACD,CAHQ,CAGN,CAACT,IAAD,CAAOC,KAAP,CAAcC,GAAd,CAHM,CAAT,CAVgG,QAejFa,CAAAA,KAfiF,yHAehG,2KACQC,EADR,CACaC,QAAQ,WAAIjB,IAAI,CAACkB,QAAL,GAAgBC,QAAhB,CAAyB,CAAzB,CAA4B,GAA5B,CAAJ,SAAuClB,KAAK,CAACiB,QAAN,GAAiBC,QAAjB,CAA0B,CAA1B,CAA6B,GAA7B,CAAvC,SAA2EjB,GAAG,CAACgB,QAAJ,GAAeC,QAAf,CAAwB,CAAxB,CAA2B,GAA3B,CAA3E,EADrB,IAGOb,KAHP,+CAIUF,CAAAA,GAAG,CAAC,CAAEY,EAAE,CAAFA,EAAF,CAAMI,OAAO,kBAAEV,MAAM,CAACG,OAAT,0CAAE,gBAAgBQ,WAAhB,CAA4B,IAA5B,CAAf,CAAkDC,IAAI,CAAEC,IAAI,CAACC,GAAL,GAAWN,QAAX,EAAxD,CAAD,CAJb,4DAMUb,CAAAA,YAAY,CAACW,EAAD,CANtB,+BAOUZ,CAAAA,GAAG,CAAC,CAAEY,EAAE,CAAFA,EAAF,CAAMI,OAAO,mBAAEV,MAAM,CAACG,OAAT,2CAAE,iBAAgBQ,WAAhB,CAA4B,IAA5B,CAAf,CAAkDC,IAAI,CAAEC,IAAI,CAACC,GAAL,GAAWN,QAAX,EAAxD,CAAD,CAPb,SAUET,kBAAkB,CAAC,KAAD,CAAlB,CACAK,SAAS,GAXX,uDAfgG,wCA6BhG,QAASA,CAAAA,SAAT,EAAsB,CACpBX,OAAO,CAACc,QAAQ,WAAIjB,IAAI,CAACkB,QAAL,GAAgBC,QAAhB,CAAyB,CAAzB,CAA4B,GAA5B,CAAJ,SAAuClB,KAAK,CAACiB,QAAN,GAAiBC,QAAjB,CAA0B,CAA1B,CAA6B,GAA7B,CAAvC,SAA2EjB,GAAG,CAACgB,QAAJ,GAAeC,QAAf,CAAwB,CAAxB,CAA2B,GAA3B,CAA3E,EAAT,CAAP,CACGM,IADH,CACQ,SAACC,CAAD,QAAOnB,CAAAA,QAAQ,CAACmB,CAAD,CAAf,EADR,EAED,CAED,mBACE,MAAC,MAAD,CAAQ,GAAR,EAAY,OAAO,CAAE,CAAEC,UAAU,CAAE,MAAd,CAArB,CAA6C,OAAO,CAAE,CAAEA,UAAU,CAAE,CAAd,CAAtD,CAAyE,UAAU,CAAE,CAAEC,KAAK,CAAE,CAAT,CAAYC,QAAQ,CAAE,GAAtB,CAArF,CAAkH,SAAS,CAAC,OAA5H,wBACE,aAAK,KAAK,CAAE,CAAEC,eAAe,CAAE,SAAnB,CAAZ,CAA4C,SAAS,CAAC,iCAAtD,wBACE,YAAI,SAAS,CAAC,mBAAd,WAAmC9B,IAAnC,WAA2CC,KAA3C,WAAoDC,GAApD,yBADF,CAGG,CAACI,KAAD,eAAU,gFAHb,CAIG,CAACE,eAAD,GAAoBF,KAApB,SAAoBA,KAApB,iBAAoBA,KAAK,CAAEc,OAA3B,gBAAsC,YAAK,SAAS,CAAC,kBAAf,CAAkC,uBAAuB,CAAE,CAAEW,MAAM,CAAEpC,GAAG,CAACW,KAAK,CAACc,OAAP,CAAb,CAA3D,EAJzC,CAMGZ,eAAe,eACd,aAAK,SAAS,CAAC,MAAf,wBACE,KAAC,SAAD,EAAW,WAAW,CAAC,gGAAvB,CAA6C,oBAAoB,CAAEG,oBAAnE,CAAyF,KAAK,CAAC,MAA/F,CAAsG,MAAM,CAAC,MAA7G,CAAoH,YAAY,CAAEL,KAAF,SAAEA,KAAF,iBAAEA,KAAK,CAAEc,OAAzI,CAAkJ,UAAU,CAAExB,YAA9J,EADF,cAEE,eAAQ,OAAO,CAAEmB,KAAjB,CAAwB,SAAS,CAAC,wCAAlC,0BAFF,GAPJ,GADF,CAcG,GAAIQ,CAAAA,IAAJ,CAASvB,IAAT,CAAeC,KAAK,CAAG,CAAvB,CAA0BC,GAA1B,EAA+B8B,OAA/B,GAA2C,GAAIT,CAAAA,IAAJ,GAAWS,OAAX,EAA3C,eAAmE,gBAAQ,SAAS,CAAC,uCAAlB,CAA0D,OAAO,CAAE,yBAAMvB,CAAAA,kBAAkB,CAAC,CAACD,eAAF,CAAxB,EAAnE,WAAgH,CAACF,KAAD,CAAS,OAAT,CAAmB,OAAnI,kBAA4I,KAAC,eAAD,EAAiB,IAAI,CAAEE,eAAe,CAAGvB,WAAH,CAAiBC,SAAvD,EAA5I,GAdtE,GADF,CAkBD","sourcesContent":["import { faCaretDown, faCaretUp } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { motion } from 'framer-motion'\nimport React, { useEffect, useRef, useState } from 'react'\nimport { useIndexedDB } from 'react-indexed-db'\nimport SunEditor from 'suneditor-react'\nimport SetOptions from 'suneditor-react/dist/types/SetOptions'\nimport SunEditorCore from 'suneditor/src/lib/core'\nimport xss from 'xss'\n\nconst editorOption: SetOptions = {\n  mode: 'inline',\n  buttonList: [\n    [\n      'paragraphStyle',\n      'blockquote',\n      'bold',\n      'underline',\n      'italic',\n      'strike',\n      'subscript',\n      'superscript',\n      'fontColor',\n      'hiliteColor',\n      'textStyle',\n      'removeFormat',\n      'outdent',\n      'indent',\n      'align',\n      'horizontalRule',\n      'list',\n      'lineHeight',\n      'table',\n      'link',\n      'image',\n      'video',\n      'audio',\n      'imageGallery',\n      'fullScreen',\n      'showBlocks',\n      'codeView',\n      'preview',\n      'template'\n    ]\n  ]\n}\n\nexport default function Card ({ year, month, day }: { year: number, month: number, day: number }) {\n  const { getByID, add, deleteRecord } = useIndexedDB('diary')\n  const [diary, setDiary] = React.useState<any>(null)\n  const [isEditorVisible, setEditorVisiblity] = useState(false)\n  const editor = useRef<SunEditorCore>()\n\n  const getSunEditorInstance = (sunEditor: SunEditorCore) => {\n    editor.current = sunEditor\n  }\n\n  useEffect(() => {\n    dataFetch()\n    setEditorVisiblity(false)\n  }, [year, month, day])\n\n  async function apply () {\n    const id = parseInt(`${year.toString().padStart(2, '0')}${month.toString().padStart(2, '0')}${day.toString().padStart(2, '0')}`)\n\n    if (!diary) {\n      await add({ id, content: editor.current?.getContents(true), date: Date.now().toString() })\n    } else {\n      await deleteRecord(id)\n      await add({ id, content: editor.current?.getContents(true), date: Date.now().toString() })\n    }\n\n    setEditorVisiblity(false)\n    dataFetch()\n  }\n\n  function dataFetch () {\n    getByID(parseInt(`${year.toString().padStart(2, '0')}${month.toString().padStart(2, '0')}${day.toString().padStart(2, '0')}`))\n      .then((v) => setDiary(v))\n  }\n\n  return (\n    <motion.div initial={{ translateX: '200%' }} animate={{ translateX: 0 }} transition={{ delay: 1, duration: 0.3 }} className=\"w-2/3\">\n      <div style={{ backgroundColor: '#353A45' }} className=\"shadow-md p-5 w-full rounded-xl\">\n        <h1 className=\"font-pen text-4xl\">{year}년 {month}월 {day}일 일기</h1>\n\n        {!diary && <p>아직 일기가 없습니다.</p>}\n        {!isEditorVisible && diary?.content && <div className=\"font-pen text-xl\" dangerouslySetInnerHTML={{ __html: xss(diary.content) }} />}\n\n        {isEditorVisible && (\n          <div className=\"py-3\">\n            <SunEditor placeholder=\"여기를 눌러 일기 작성을 시작하세요\" getSunEditorInstance={getSunEditorInstance} width=\"100%\" height=\"30vh\" defaultValue={diary?.content} setOptions={editorOption} />\n            <button onClick={apply} className=\"mt-3 rounded-md bg-green-500 px-3 py-2\">완료</button>\n          </div>\n        )}\n      </div>\n      {new Date(year, month - 1, day).getTime() < new Date().getTime() && <button className=\"bg-gray-500 rounded-md px-3 py-2 mt-5\" onClick={() => setEditorVisiblity(!isEditorVisible)}>{!diary ? '일기 쓰기' : '일기 편집'} <FontAwesomeIcon icon={isEditorVisible ? faCaretDown : faCaretUp}/></button>}\n    </motion.div>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}