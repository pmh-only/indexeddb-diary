{"ast":null,"code":"/*\n * wysiwyg web editor\n *\n * suneditor.js\n * Copyright 2019 JiHong Lee.\n * MIT license.\n */\n'use strict';\n\nexport default function (core, change) {\n  var _w = core._w;\n  var util = core.util;\n  var delayTime = core.options.historyStackDelayTime;\n  var editor = core.context.element;\n  var undo = core.context.tool.undo;\n  var redo = core.context.tool.redo;\n  var pushDelay = null;\n  var stackIndex = 0;\n  var stack = [];\n\n  function setContentsFromStack() {\n    var item = stack[stackIndex];\n    editor.wysiwyg.innerHTML = item.contents;\n    core.setRange(util.getNodeFromPath(item.s.path, editor.wysiwyg), item.s.offset, util.getNodeFromPath(item.e.path, editor.wysiwyg), item.e.offset);\n    core.focus();\n\n    if (stack.length <= 1) {\n      if (undo) undo.setAttribute('disabled', true);\n      if (redo) redo.setAttribute('disabled', true);\n    } else {\n      if (stackIndex === 0) {\n        if (undo) undo.setAttribute('disabled', true);\n        if (redo) redo.removeAttribute('disabled');\n      } else if (stackIndex === stack.length - 1) {\n        if (undo) undo.removeAttribute('disabled');\n        if (redo) redo.setAttribute('disabled', true);\n      } else {\n        if (undo) undo.removeAttribute('disabled');\n        if (redo) redo.removeAttribute('disabled');\n      }\n    }\n\n    core.controllersOff();\n\n    core._checkComponents();\n\n    core._setCharCount();\n\n    core._resourcesStateChange(); // onChange\n\n\n    change();\n  }\n\n  function pushStack() {\n    core._checkComponents();\n\n    var current = core.getContents(true);\n    if (!current || !!stack[stackIndex] && current === stack[stackIndex].contents) return;\n    stackIndex++;\n    var range = core._variable._range;\n\n    if (stack.length > stackIndex) {\n      stack = stack.slice(0, stackIndex);\n      if (redo) redo.setAttribute('disabled', true);\n    }\n\n    if (!range) {\n      stack[stackIndex] = {\n        contents: current,\n        s: {\n          path: [0, 0],\n          offset: [0, 0]\n        },\n        e: {\n          path: 0,\n          offset: 0\n        }\n      };\n    } else {\n      stack[stackIndex] = {\n        contents: current,\n        s: {\n          path: util.getNodePath(range.startContainer, null, null),\n          offset: range.startOffset\n        },\n        e: {\n          path: util.getNodePath(range.endContainer, null, null),\n          offset: range.endOffset\n        }\n      };\n    }\n\n    if (stackIndex === 1 && undo) undo.removeAttribute('disabled');\n\n    core._setCharCount(); // onChange\n\n\n    change();\n  }\n\n  return {\n    /**\n     * @description History stack\n     */\n    stack: stack,\n\n    /**\n     * @description Saving the current status to the history object stack\n     * If \"delay\" is true, it will be saved after (options.historyStackDelayTime || 400) miliseconds\n     * If the function is called again with the \"delay\" argument true before it is saved, the delay time is renewal\n     * You can specify the delay time by sending a number.\n     * @param {Boolean|Number} delay If true, Add stack without delay time.\n     */\n    push: function push(delay) {\n      _w.setTimeout(core._resourcesStateChange.bind(core));\n\n      var time = typeof delay === 'number' ? delay > 0 ? delay : 0 : !delay ? 0 : delayTime;\n\n      if (!time || pushDelay) {\n        _w.clearTimeout(pushDelay);\n\n        if (!time) {\n          pushStack();\n          return;\n        }\n      }\n\n      pushDelay = _w.setTimeout(function () {\n        _w.clearTimeout(pushDelay);\n\n        pushDelay = null;\n        pushStack();\n      }, time);\n    },\n\n    /**\n     * @description Undo function\n     */\n    undo: function undo() {\n      if (stackIndex > 0) {\n        stackIndex--;\n        setContentsFromStack();\n      }\n    },\n\n    /**\n     * @description Redo function\n     */\n    redo: function redo() {\n      if (stack.length - 1 > stackIndex) {\n        stackIndex++;\n        setContentsFromStack();\n      }\n    },\n\n    /**\n     * @description Go to the history stack for that index.\n     * If \"index\" is -1, go to the last stack\n     */\n    go: function go(index) {\n      stackIndex = index < 0 ? stack.length - 1 : index;\n      setContentsFromStack();\n    },\n\n    /**\n     * @description Get the current history stack index.\n     * @returns {Number} Current Stack index\n     */\n    getCurrentIndex: function getCurrentIndex() {\n      return stackIndex;\n    },\n\n    /**\n     * @description Reset the history object\n     */\n    reset: function reset(ignoreChangeEvent) {\n      if (undo) undo.setAttribute('disabled', true);\n      if (redo) redo.setAttribute('disabled', true);\n      core._variable.isChanged = false;\n      if (core.context.tool.save) core.context.tool.save.setAttribute('disabled', true);\n      stack.splice(0);\n      stackIndex = 0; // pushStack\n\n      stack[stackIndex] = {\n        contents: core.getContents(true),\n        s: {\n          path: [0, 0],\n          offset: 0\n        },\n        e: {\n          path: [0, 0],\n          offset: 0\n        }\n      };\n      if (!ignoreChangeEvent) change();\n    },\n\n    /**\n     * @description Reset the disabled state of the buttons to fit the current stack.\n     * @private\n     */\n    _resetCachingButton: function _resetCachingButton() {\n      editor = core.context.element;\n      undo = core.context.tool.undo;\n      redo = core.context.tool.redo;\n\n      if (stackIndex === 0) {\n        if (undo) undo.setAttribute('disabled', true);\n        if (redo && stackIndex === stack.length - 1) redo.setAttribute('disabled', true);\n        core._variable.isChanged = false;\n        if (core.context.tool.save) core.context.tool.save.setAttribute('disabled', true);\n      } else if (stackIndex === stack.length - 1) {\n        if (redo) redo.setAttribute('disabled', true);\n      }\n    },\n\n    /**\n     * @description Remove all stacks and remove the timeout function.\n     * @private\n     */\n    _destroy: function _destroy() {\n      if (pushDelay) _w.clearTimeout(pushDelay);\n      stack = null;\n    }\n  };\n}","map":{"version":3,"sources":["/github/workspace/node_modules/suneditor/src/lib/history.js"],"names":["core","change","_w","util","delayTime","options","historyStackDelayTime","editor","context","element","undo","tool","redo","pushDelay","stackIndex","stack","setContentsFromStack","item","wysiwyg","innerHTML","contents","setRange","getNodeFromPath","s","path","offset","e","focus","length","setAttribute","removeAttribute","controllersOff","_checkComponents","_setCharCount","_resourcesStateChange","pushStack","current","getContents","range","_variable","_range","slice","getNodePath","startContainer","startOffset","endContainer","endOffset","push","delay","setTimeout","bind","time","clearTimeout","go","index","getCurrentIndex","reset","ignoreChangeEvent","isChanged","save","splice","_resetCachingButton","_destroy"],"mappings":"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","sourcesContent":["/*\n * wysiwyg web editor\n *\n * suneditor.js\n * Copyright 2019 JiHong Lee.\n * MIT license.\n */\n'use strict';\n\nexport default function (core, change) {\n    const _w = core._w;\n    const util = core.util;\n    const delayTime = core.options.historyStackDelayTime;\n    let editor = core.context.element;\n    let undo = core.context.tool.undo;\n    let redo = core.context.tool.redo;\n\n    let pushDelay = null;\n    let stackIndex = 0;\n    let stack = [];\n\n    function setContentsFromStack () {\n        const item = stack[stackIndex];\n        editor.wysiwyg.innerHTML = item.contents;\n\n        core.setRange(util.getNodeFromPath(item.s.path, editor.wysiwyg), item.s.offset, util.getNodeFromPath(item.e.path, editor.wysiwyg), item.e.offset);\n        core.focus();\n\n        if (stack.length <= 1) {\n            if (undo) undo.setAttribute('disabled', true);\n            if (redo) redo.setAttribute('disabled', true);\n        } else {\n            if (stackIndex === 0) {\n                if (undo) undo.setAttribute('disabled', true);\n                if (redo) redo.removeAttribute('disabled');\n            } else if (stackIndex === stack.length - 1) {\n                if (undo) undo.removeAttribute('disabled');\n                if (redo) redo.setAttribute('disabled', true);\n            } else {\n                if (undo) undo.removeAttribute('disabled');\n                if (redo) redo.removeAttribute('disabled');\n            }\n        }\n\n        core.controllersOff();\n        core._checkComponents();\n        core._setCharCount();\n        core._resourcesStateChange();\n        \n        // onChange\n        change();\n    }\n\n    function pushStack () {\n        core._checkComponents();\n        const current = core.getContents(true);\n        if (!current || (!!stack[stackIndex] && current === stack[stackIndex].contents)) return;\n\n        stackIndex++;\n        const range = core._variable._range;\n\n        if (stack.length > stackIndex) {\n            stack = stack.slice(0, stackIndex);\n            if (redo) redo.setAttribute('disabled', true);\n        }\n\n        if (!range) {\n            stack[stackIndex] = {\n                contents: current,\n                s: { path: [0, 0], offset: [0, 0] },\n                e: { path: 0, offset: 0 }\n            };\n        } else {\n            stack[stackIndex] = {\n                contents: current,\n                s: {\n                    path: util.getNodePath(range.startContainer, null, null),\n                    offset: range.startOffset\n                },\n                e: {\n                    path: util.getNodePath(range.endContainer, null, null),\n                    offset: range.endOffset\n                }\n            };\n        }\n\n        if (stackIndex === 1 && undo) undo.removeAttribute('disabled');\n\n        core._setCharCount();\n        // onChange\n        change();\n    }\n\n    return {\n        /**\n         * @description History stack\n         */\n        stack: stack,\n\n        /**\n         * @description Saving the current status to the history object stack\n         * If \"delay\" is true, it will be saved after (options.historyStackDelayTime || 400) miliseconds\n         * If the function is called again with the \"delay\" argument true before it is saved, the delay time is renewal\n         * You can specify the delay time by sending a number.\n         * @param {Boolean|Number} delay If true, Add stack without delay time.\n         */\n        push: function (delay) {\n            _w.setTimeout(core._resourcesStateChange.bind(core));\n            const time = typeof delay === 'number' ? (delay > 0 ? delay : 0) : (!delay ? 0 : delayTime);\n            \n            if (!time || pushDelay) {\n                _w.clearTimeout(pushDelay);\n                if (!time) {\n                    pushStack();\n                    return;\n                }\n            }\n\n            pushDelay = _w.setTimeout(function () {\n                _w.clearTimeout(pushDelay);\n                pushDelay = null;\n                pushStack();\n            }, time);\n        },\n\n        /**\n         * @description Undo function\n         */\n        undo: function () {\n            if (stackIndex > 0) {\n                stackIndex--;\n                setContentsFromStack();\n            }\n        },\n\n        /**\n         * @description Redo function\n         */\n        redo: function () {\n            if (stack.length - 1 > stackIndex) {\n                stackIndex++;\n                setContentsFromStack();\n            }\n        },\n\n        /**\n         * @description Go to the history stack for that index.\n         * If \"index\" is -1, go to the last stack\n         */\n        go: function (index) {\n            stackIndex = index < 0 ? (stack.length - 1) : index;\n            setContentsFromStack();\n        },\n\n        /**\n         * @description Get the current history stack index.\n         * @returns {Number} Current Stack index\n         */\n        getCurrentIndex: function () {\n            return stackIndex;\n        },\n        \n        /**\n         * @description Reset the history object\n         */\n        reset: function (ignoreChangeEvent) {\n            if (undo) undo.setAttribute('disabled', true);\n            if (redo) redo.setAttribute('disabled', true);\n            core._variable.isChanged = false;\n            if (core.context.tool.save) core.context.tool.save.setAttribute('disabled', true);\n            \n            stack.splice(0);\n            stackIndex = 0;\n\n            // pushStack\n            stack[stackIndex] = {\n                contents: core.getContents(true),\n                s: {\n                    path: [0, 0],\n                    offset: 0\n                },\n                e: {\n                    path: [0, 0],\n                    offset: 0\n                }\n            };\n\n            if (!ignoreChangeEvent) change();\n        },\n\n        /**\n         * @description Reset the disabled state of the buttons to fit the current stack.\n         * @private\n         */\n        _resetCachingButton: function () {\n            editor = core.context.element;\n            undo = core.context.tool.undo;\n            redo = core.context.tool.redo;\n\n            if (stackIndex === 0) {\n                if (undo) undo.setAttribute('disabled', true);\n                if (redo && stackIndex === stack.length - 1) redo.setAttribute('disabled', true);\n                core._variable.isChanged = false;\n                if (core.context.tool.save) core.context.tool.save.setAttribute('disabled', true);\n            } else if (stackIndex === stack.length - 1) {\n                if (redo) redo.setAttribute('disabled', true);\n            }\n        },\n\n        /**\n         * @description Remove all stacks and remove the timeout function.\n         * @private\n         */\n        _destroy: function () {\n            if (pushDelay) _w.clearTimeout(pushDelay);\n            stack = null;\n        }\n    };\n}"]},"metadata":{},"sourceType":"module"}